functions:
  - query-parameters-pagination
  - operation-id
  
rules:
  bpi-resource-attributes-description:
    description: Every attribute inside properties SHOULD have the description.
    message: Model properties SHOULD have a description.
    severity: warn
    given: $..properties[?(@.type !== "object")]*
    recommended: true
    then:
      field: description
      function: truthy

  bpi-resource-attributes-examples:
    description: Model property `examples` SHOULD be present and non-empty string.
    message: Every attribute SHOULD have an example.
    recommended: true
    type: style
    given: $..properties[?(@.type == "string" || @.type == "integer" || @.type == "number")]*
    then:
      field: example
      function: truthy

  bpi-validate-content-in-response-body:
    description: The HTTP codes [200,201,202,206,400,404,409,500] MUST have content and description.
    message: Verbs MUST have content and description in response body.
    given: $.paths..responses.[200,201,202,206,400,404,409,500]*
    severity: error
    then:
      - field: description
        function: truthy
      - field: content
        function: truthy

  bpi-query-parameters-list:
    description: Get List verbs is mandatory have queryParameters.
    message: GET List verbs MUST have queryParameters.
    severity: error
    given: [
      "$.paths[?(@property.indexOf('/{id}') == -1)].get",
      "$.paths[?(@property.indexOf('/{id}/') !== -1)].get"
      ]
    then:
      field: parameters
      function: truthy

  bpi-query-parameters-pagination:
    description: To pagintation is mandatory have pageNumber e pageSize in queryParameters.
    message: GET List verbs MUST have queryParameters for Pagination (pageNumber, pageSize)
    severity: error
    given: $.paths.*.get.parameters
    then:
      function: query-parameters-pagination

  bpi-validate-operation-id:
    description: Validate that operation-id is compliant to BPI rules.
    severity: error
    given: $.paths..operationId
    then:
      function: operation-id

  bpi-resource-attributes-max-lenght:
    description: Every attribute of type string and not date, must have the maxlength.
    message: All attributes of type string MUST have maxLenght.
    recommended: true
    type: style
    given: $..properties[?(@.type == "string")]*
    severity: error
    then:
      - field: maxLength
        function: truthy